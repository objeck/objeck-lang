use Collection, Web.HTTP, System.IO.Filesystem;

class Test {
	function : Main(args : String[]) ~ Nil {
		text := FileReader->ReadFile("lorem.txt");
		text_size := text->Size();

		text_size->PrintLine();
		"---"->PrintLine();
#~
		(text_size and 0xff)->PrintLine();
		((text_size >> 8) and 0xff)->PrintLine();
~#

		client := HttpsClient->New();
		if(client->OpenTextSocket(Url->New("wss://echo.websocket.org"))) {
			client->ReadTextSocket()->PrintLine();

#			client->WriteTextSocket("Hello World!");
			client->WriteTextSocket(text);
			client->ReadTextSocket()->PrintLine();
			
			client->CloseSocket();
		}
		else {
		};
	}
}
